ISSUER_URL=http://localhost:8080
ACCESS_TOKEN_TTL_SECONDS=1800
REFRESH_TOKEN_TTL_SECONDS=2592000
DEFAULT_AUD_PREFIX=tymoe-service
TENANT_ENFORCE_AUD=true
INTROSPECT_CLIENT_ID=gateway
INTROSPECT_CLIENT_SECRET=gateway-secret
JWKS_MAX_AGE_SEC=3600

# Identity Management
DEFAULT_TENANT_ID=tenant-dev
PASSWORD_HASH_ROUNDS=10

# === SMTP (生产环境) ===
MAIL_TRANSPORT=CONSOLE
SMTP_HOST=mail.eazy.solutions
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=noreply@tymoe.com
SMTP_PASS=<&,48,RoneAD>
SMTP_AUTH_USER=noreply@tymoe.com
SMTP_AUTH_PASS=<&,48,RoneAD>
MAIL_FROM="Tymoe Auth <no-reply@tymoe.com>"
MAIL_REPLY_TO="support@tymoe.com"

# === Redis ===
REDIS_URL=redis://127.0.0.1:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_NAMESPACE=authsvc
REDIS_CONNECT_TIMEOUT=5000
REDIS_COMMAND_TIMEOUT=3000
REDIS_MAX_RETRIES=3

# === 验证码复用/有效期（分钟） ===
VERIFY_CODE_TTL_MIN=10
VERIFY_REUSE_WINDOW_MIN=10
RESET_CODE_TTL_MIN=10
RESET_REUSE_WINDOW_MIN=10

# === 限流阈值（每小时上限），邮箱与IP都应用 ===
RATE_MAX_REGISTER_PER_HR=10
RATE_MAX_VERIFY_PER_HR=10
RATE_MAX_RESET_PER_HR=10
RATE_MAX_LOGIN_PER_HR=10

# === 登录失败阈值 ===
LOGIN_CAPTCHA_THRESHOLD=3
LOGIN_LOCK_THRESHOLD=10
LOGIN_LOCK_MINUTES=30

# === reCAPTCHA（可选，未启用可置空并禁用） ===
CAPTCHA_ENABLED=false
CAPTCHA_SITE_KEY=
CAPTCHA_SECRET_KEY=
CAPTCHA_VERIFY_URL=https://www.google.com/recaptcha/api/siteverify

# === 兼容性保留（向后兼容） ===
SIGNUP_CODE_TTL_SEC=600
RESET_CODE_TTL_SEC=600
CODE_ATTEMPT_MAX=5
VERIFICATION_CODE_REUSE_WINDOW_SEC=600
RATE_WINDOW_SEC=60
RATE_MAX_LOGIN=5
RATE_MAX_REGISTER=5
RATE_MAX_RESET=5
RATE_LOGIN_EMAIL_MAX=10
RATE_LOGIN_EMAIL_WINDOW_SEC=3600
RATE_LOGIN_IP_MAX=50
RATE_LOGIN_IP_WINDOW_SEC=3600
LOGIN_MAX_FAILURES=10
LOGIN_LOCKOUT_DURATION_SEC=1800

# Audit and Security
AUDIT_TO_FILE=true
AUDIT_FILE_PATH=./logs/audit.log
ENHANCED_AUDIT_LOGGING=true

# Audience validation
ALLOWED_AUDIENCES=tymoe-service