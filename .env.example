ISSUER_URL=http://localhost:8080
ACCESS_TOKEN_TTL_SECONDS=1800
REFRESH_TOKEN_TTL_SECONDS=2592000
DEFAULT_AUD_PREFIX=tymoe-service
TENANT_ENFORCE_AUD=true
INTROSPECT_CLIENT_ID=gateway
INTROSPECT_CLIENT_SECRET=gateway-secret
JWKS_MAX_AGE_SEC=3600

# Identity Management
DEFAULT_TENANT_ID=tenant-dev
PASSWORD_HASH_ROUNDS=10

# Redis Configuration for Caching and Rate Limiting
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_CONNECT_TIMEOUT=5000
REDIS_COMMAND_TIMEOUT=3000
REDIS_MAX_RETRIES=3

# Email sending (CONSOLE for development, SMTP for production)
MAIL_TRANSPORT=CONSOLE
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_user
SMTP_PASS=your_pass
SMTP_AUTH_USER=your_user
SMTP_AUTH_PASS=your_pass
MAIL_FROM="Tymoe Auth <no-reply@tymoe.com>"
MAIL_REPLY_TO="support@tymoe.com"

# Verification codes and reset tokens (v0.2.6 enhanced)
SIGNUP_CODE_TTL_SEC=900
RESET_CODE_TTL_SEC=900
CODE_ATTEMPT_MAX=5
VERIFICATION_CODE_REUSE_WINDOW_SEC=600

# Rate limiting for identity endpoints (v0.2.6 enhanced with dual dimensions)
RATE_WINDOW_SEC=60
RATE_MAX_LOGIN=5
RATE_MAX_REGISTER=5
RATE_MAX_RESET=5

# Dual-dimension rate limiting (email + IP)
RATE_LOGIN_EMAIL_MAX=10
RATE_LOGIN_EMAIL_WINDOW_SEC=3600
RATE_LOGIN_IP_MAX=50
RATE_LOGIN_IP_WINDOW_SEC=3600

# Login failure tracking and lockout
LOGIN_MAX_FAILURES=10
LOGIN_LOCKOUT_DURATION_SEC=1800
LOGIN_CAPTCHA_THRESHOLD=3
CAPTCHA_ENABLED=false

# CAPTCHA Configuration (optional)
CAPTCHA_SITE_KEY=
CAPTCHA_SECRET_KEY=
CAPTCHA_VERIFY_URL=https://www.google.com/recaptcha/api/siteverify

# Audit and Security
AUDIT_TO_FILE=true
AUDIT_FILE_PATH=./logs/audit.log
ENHANCED_AUDIT_LOGGING=true

# Audience validation
ALLOWED_AUDIENCES=tymoe-service